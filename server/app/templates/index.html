<!-- Public Landing Page -->
{% extends "base.html" %} {% block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/auth.css') }}"
/>
{% endblock %} {% block title %}Port Scanner Delta Reporter - Murdoch
University{% endblock %} {% block content %}

<!-- ==================== -->
<!-- HERO SECTION -->
<!-- ==================== -->
<div class="hero-section">
  <div class="container-fluid">
    <div class="row align-items-center g-5">
      <!-- LEFT SIDE - Image -->
      <div class="col-lg-3 d-flex align-items-center">
        <div class="hero-image-container">
          <img
            src="{{ url_for('static', filename='images/delta.png') }}"
            alt="delta icon image"
            class="hero-image"
            onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'"
          />
          <div class="hero-image-placeholder" style="display: none">
            <i
              class="bi bi-diagram-3"
              style="font-size: 8rem; color: rgba(255, 255, 255, 0.3)"
            ></i>
          </div>
        </div>
      </div>

      <!-- CENTRE - Title & Description -->
      <div class="col-lg-5">
        <h1 class="hero-title">Port Scanner & Delta Reporter</h1>
        <p class="hero-subtitle">
          A Network Security Monitoring Tool for Murdoch University
        </p>
        <div class="status-badge my-2">
          <span class="status-indicator status-online animated"></span>
          <span class="text-muted"
            >System Status: <strong class="text-success">Online</strong></span
          >
        </div>
      </div>

      <!-- RIGHT SIDE - Login Form or Welcome Panel -->
      <div class="col-lg-4" style="display: flex; align-items: flex-end">
        {% if current_user.is_authenticated %}
        <!-- AUTHENTICATED USER - Welcome Panel -->
        <div class="authenticated-panel">
          <div class="welcome-message">
            <i class="bi bi-person-check-fill"></i>
            <span
              >Welcome back, <strong>{{ current_user.username }}</strong></span
            >
          </div>
          <a
            href="{{ url_for('dashboard.index') }}"
            class="btn btn-light btn-lg w-100 mt-3"
          >
            <i class="bi bi-speedometer2"></i> Go to Dashboard
          </a>
        </div>
        {% else %}
        <!-- UNAUTHENTICATED USER - Login Form -->
        <div class="login-form-container">
          <h3 class="login-panel-title mb-4">Sign In</h3>

          <!-- Flash Messages -->
          {% with messages = get_flashed_messages(with_categories=true) %} {% if
          messages %} {% for category, message in messages %}
          <div
            class="alert alert-{{ category }} alert-dismissible fade show"
            role="alert"
          >
            {{ message }}
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
            ></button>
          </div>
          {% endfor %} {% endif %} {% endwith %}

          <!-- Login Form: use WTForms if `form` provided, otherwise fallback to plain HTML form -->
          {% if form is defined %}
          <form method="POST" action="{{ url_for('auth.login') }}">
            {{ form.hidden_tag() }}

            <!-- Username Field -->
            <div class="mb-3">
              <label for="username" class="form-label">Username</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i class="bi bi-person"></i>
                </span>
                {{ form.username(class="form-control" + (" is-invalid" if
                form.username.errors else ""), placeholder="Enter your
                username") }}
              </div>
              {% if form.username.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.username.errors %} {{ error }} {% endfor %}
              </div>
              {% endif %}
            </div>

            <!-- Password Field -->
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i class="bi bi-lock"></i>
                </span>
                {{ form.password(class="form-control" + (" is-invalid" if
                form.password.errors else ""), placeholder="••••••••") }}
              </div>
              {% if form.password.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.password.errors %} {{ error }} {% endfor %}
              </div>
              {% endif %}
            </div>

            <!-- Remember Me -->
            <div class="mb-3 form-check">
              {{ form.remember(class="form-check-input", id="remember") }}
              <label class="form-check-label" for="remember">
                Remember me
              </label>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary w-100">
              <i class="bi bi-box-arrow-in-right"></i> Sign In
            </button>
          </form>
          {% else %}
          <!-- Fallback plain HTML form when WTForms `form` is not supplied by the view -->
          <form method="POST" action="{{ url_for('auth.login') }}">
            <div class="mb-3">
              <label for="username" class="form-label">Username</label>
              <div class="input-group">
                <span class="input-group-text"
                  ><i class="bi bi-person"></i
                ></span>
                <input
                  type="text"
                  name="username"
                  id="username"
                  class="form-control"
                  placeholder="Enter your username"
                  required
                />
              </div>
            </div>

            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-lock"></i></span>
                <input
                  type="password"
                  name="password"
                  id="password"
                  class="form-control"
                  placeholder="••••••••"
                  required
                />
              </div>
            </div>

            <div class="mb-3 form-check">
              <input
                type="checkbox"
                name="remember"
                id="remember"
                class="form-check-input"
              />
              <label class="form-check-label" for="remember">Remember me</label>
            </div>

            <button type="submit" class="btn btn-primary w-100">
              <i class="bi bi-box-arrow-in-right"></i> Sign In
            </button>
          </form>
          {% endif %}

          <!-- Footer -->
          <div class="login-footer text-center mt-3">
            <small class="text-muted">
              Need access? Contact your system administrator.
            </small>
          </div>
        </div>
        {% endif %}
      </div>
      <!-- Close col-lg-4 -->
    </div>
    <!-- Close row -->
  </div>
  <!-- Close container -->
</div>
<!-- Close hero-section -->

<!-- system status moved into hero center column -->

{% endblock %}
