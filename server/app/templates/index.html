<!-- Public Landing Page -->
{% extends "base.html" %} {% block extra_css %} {% endblock %} {% block title %}Port Scanner Delta
Reporter - Murdoch University{% endblock %} {% block content %}

<!-- Background & Formatting -->
<div class="container-fluid py-3">
  <div class="row align-items-center g-4">
    <!-- LEFT SIDE - Image -->
    <section class="py-3">
      <div class="container">
        <div class="row align-items-center g-5">
          <!-- LEFT: Image -->
          <div class="col-lg-3 text-center">
            <img
              src="{{ url_for('static', filename='images/delta.png') }}"
              alt="Delta icon"
              class="img-fluid rounded"
              style="max-width: 250px; animation: float-gentle 4s ease-in-out infinite"
              onerror="this.style.display='none';" />
          </div>

          <!-- CENTER: Title & Description -->
          <div class="col-lg-5 text-center text-lg-start">
            <h1 class="display-5 fw-bold mb-3">Port Scanner & Delta Reporter</h1>
            <p class="lead mb-4">A Network Security Monitoring Tool for Murdoch University</p>

            <!-- Status Badge -->
            <div
              class="d-flex align-items-center justify-content-center justify-content-lg-start gap-2">
              <i
                class="bi bi-circle-fill text-success"
                style="font-size: 12px; animation: statusPulse 1.6s ease-in-out infinite"></i>
              <span class="text-muted">
                System Status: <strong class="text-success">Online</strong>
              </span>
            </div>
          </div>

          <!-- RIGHT: Login / Welcome Panel -->
          <div class="col-lg-4">
            {% if current_user.is_authenticated %}
            <div class="card shadow text-center p-4">
              <i class="bi bi-person-check-fill display-5 text-primary mb-3"></i>
              <h5>Welcome back, <strong>{{ current_user.username }}</strong></h5>
              <a href="{{ url_for('dashboard.index') }}" class="btn btn-primary w-100 mt-3">
                Go to Dashboard
              </a>
            </div>
            {% else %}
            <div class="card shadow p-4">
              <h4 class="text-center mb-4">Sign In</h4>

              <!-- Flash Messages -->
              {% with messages = get_flashed_messages(with_categories=true) %} {% if messages %} {%
              for category, message in messages %}
              <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
              {% endfor %} {% endif %} {% endwith %}


              <!-- Microsoft SSO Button -->
              <div class="mb-">
                <a href="{{ url_for('auth.entra_login') }}" class="btn btn-lg w-100 border shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 21 21"
                    class="me-2">
                    <rect x="1" y="1" width="9" height="9" fill="#f25022" />
                    <rect x="11" y="1" width="9" height="9" fill="#7fba00" />
                    <rect x="1" y="11" width="9" height="9" fill="#00a4ef" />
                    <rect x="11" y="11" width="9" height="9" fill="#ffb900" />
                  </svg>
                  Sign in with Microsoft
                </a>
              </div>

              <!-- Divider -->
              <div class="position-relative my-3">
                <hr class="text-muted" />
                <span class="position-absolute top-50 start-50 translate-middle bg-body px-3 text-muted small text-nowrap">
                  Or sign in with username
                </span>
              </div>

              <!-- Login Form -->
              {% if form is defined %}
              <form method="POST" action="{{ url_for('auth.login') }}">
                {{ form.hidden_tag() }}

                <div class="mb-3">
                  <label for="username" class="form-label">Username</label>
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                    {{ form.username(class="form-control" + (" is-invalid" if form.username.errors
                    else ""), placeholder="Enter your username") }}
                  </div>
                  {% if form.username.errors %}
                  <div class="invalid-feedback d-block">
                    {% for error in form.username.errors %}{{ error }}{% endfor %}
                  </div>
                  {% endif %}
                </div>

                <div class="mb-3">
                  <label for="password" class="form-label">Password</label>
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-lock"></i></span>
                    {{ form.password(class="form-control" + (" is-invalid" if form.password.errors
                    else ""), placeholder="••••••••") }}
                  </div>
                  {% if form.password.errors %}
                  <div class="invalid-feedback d-block">
                    {% for error in form.password.errors %}{{ error }}{% endfor %}
                  </div>
                  {% endif %}
                </div>

                <div class="mb-3 form-check">
                  {{ form.remember(class="form-check-input", id="remember") }}
                  <label class="form-check-label" for="remember">Remember me</label>
                </div>

                <button type="submit" class="btn btn-primary w-100">
                  <i class="bi bi-box-arrow-in-right"></i> Sign In
                </button>
              </form>
              {% else %}
              <!-- Fallback if form object not provided -->
              <form method="POST" action="{{ url_for('auth.login') }}">
                <div class="mb-3">
                  <label for="username" class="form-label">Username</label>
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                    <input
                      type="text"
                      name="username"
                      id="username"
                      class="form-control"
                      placeholder="Enter your username"
                      required />
                  </div>
                </div>

                <div class="mb-3">
                  <label for="password" class="form-label">Password</label>
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-lock"></i></span>
                    <input
                      type="password"
                      name="password"
                      id="password"
                      class="form-control"
                      placeholder="••••••••"
                      required />
                  </div>
                </div>

                <div class="mb-3 form-check">
                  <input type="checkbox" name="remember" id="remember" class="form-check-input" />
                  <label class="form-check-label" for="remember">Remember me</label>
                </div>

                <button type="submit" class="btn btn-gradient-primary w-100">
                  <i class="bi bi-box-arrow-in-right"></i> Sign In
                </button>
              </form>
              {% endif %}

              <!-- Register Link -->
              <div class="text-center mt-4">
                <p class="text-muted mb-2">Don't have an account?</p>
                <a href="{{ url_for('auth.register') }}" class="btn btn-outline-secondary">
                  <i class="bi bi-person-plus me-2"></i>Create Account
                </a>
              </div>

            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </section>

    <!-- Key Features Section (compact three-column layout) -->
    <section class="py-5 bg-body border-top">
      <div class="container text-center">
        <h2 class="fw-bold mb-3">Key Features</h2>
        <p class="text-muted mb-5">Why choose Port Scanner & Delta Reporter?</p>

        <div class="row g-4">
          <div class="col-md-4">
            <div class="card shadow text-center p-4">
              <div class="card-body">
                <i class="bi bi-lightning-charge text-primary display-6 mb-3"></i>
                <h5>Fast Scanning</h5>
                <p class="text-muted">
                  Quickly scan networks and ports with optimized performance and reliability.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow text-center p-4">
              <div class="card-body">
                <i class="bi bi-bar-chart-line text-success display-6 mb-3"></i>
                <h5>Delta Reporting</h5>
                <p class="text-muted">
                  Track changes and differences in scan results for actionable insights and alerts.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow text-center p-4">
              <div class="card-body">
                <i class="bi bi-shield-lock text-warning display-6 mb-3"></i>
                <h5>Secure Architecture</h5>
                <p class="text-muted">
                  Built with security best practices to protect your data and infrastructure.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  {% endblock %}
</div>
